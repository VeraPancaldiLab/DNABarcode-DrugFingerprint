{
  "hash": "4004108c399077ab41f75fe8b3f366cc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data management: metadata correction and cleansing\"\n---\n\n\n\n\n\n\n## Reproducibility\n\nI list below the R packages required to reproduce the analyses.\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## data wrangling\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(readr)\nlibrary(readxl)\nlibrary(purrr)\n\n## reporting\nlibrary(flextable)\n\n## plotting\nlibrary(ggplot2)\nlibrary(ComplexHeatmap)\nlibrary(cowplot)\nlibrary(grid)\nlibrary(RColorBrewer)\nlibrary(igraph)\n\n## auxiliary functions\nsource(\"R/utils.R\")\ntoday_date <- \"2025-04-28\"\n## today_date <- format(Sys.Date(), \"%Y-%m-%d\")\n\n## set the seed, for fixing generation of ComplexHeatmaps (dendogram clustering)\nset.seed(20)\n```\n:::\n\n\n\n\n\n\n- [Original Google Drive repository](https://drive.google.com/drive/folders/1pMSX4M4kHcDGxcsCzsMYHHM6VRvBHHUO).\n\n    \n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n\n\n    \n## Barcode counts cleaning {#sec-select-exp}\n\nWe early discarded `exp130921_in vivo.csv` from the experiences\n\n<!-- - ['Experiment Date': `130921` and 'Run Date': `101121` ]{fg=\"red\"} -->\n\n<!-- ```{r} -->\n<!-- #| label: select-expression-130921 -->\n<!-- #| eval: false -->\n<!-- #| echo: false -->\n\n<!-- exp130921_expression <- readr::read_csv(\"data/barcode-counts/exp130921.csv\")  -->\n<!-- exp130921_1_expression <- readr::read_csv(\"data/barcode-counts/exp130921_1.csv\")  -->\n<!-- selected_dataset <- compare_dataframes(exp130921_expression, exp130921_1_expression) -->\n<!-- ``` -->\n\n<!-- [Conclusion: Keep `exp130921.csv`, and discard expression file `exp130921_1.csv`. The latter indeed exhibited fewer barcode IDs, while on the shared overlap, both datasets are identical.]{fg=\"red\"} -->\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{#lst-rename-bad-date .r .cell-code  lst-cap=\"Update labelling of latest experience.\"}\nexp271221 <- readr::read_csv(\"data/barcode-counts/exp271221.csv\") \nexp271221_whole <- readr::read_csv2(\"old-data-backup/data-raw/barcode-counts/exp211221cor.csv\") |> \n  rename(barcode_id = 1)\nselected_dataset <- compare_dataframes(exp271221, exp271221_whole)\n\nfile.rename(\"data/barcode-counts/exp211221.csv\", \"data/barcode-counts/exp271221.csv\") \n```\n:::\n\n\n\n\n\n\n[In @lst-rename-bad-date, we rename expression file `exp211221.csv` into `exp271221.csv`, relying on date annotations.]{fg=\"red\"}\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n\n\n[While the *dose-response* experience `exp200921_dose response osim` exhibits distinct biological objective, it turned out that the 4 control biological replicates are shared with classical compound response comparison `exp200921.csv`. However, **the number of sequenced barcode IDs differ in both experiences!!** In addition, note that `exp200921.csv` has been tagged as discarded, except for the Controls!!]{fg=\"red\"}\n  \nCode snippets in @lst-281022 and @lst-281022-time-course aim at replacing unprecise labelling of barcode IDs (no concentration, no time duration, ...) in the 2022 batch experiences.\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{#lst-281022 .r .cell-code  lst-cap=\"Update labelling of latest experience.\"}\n## extract old colnames\nexp281022_expression <- readr::read_csv(\"data/barcode-counts/exp281022.csv\") \n## cat(colnames(exp281022_expression), file = \"281022_old_labels.txt\", sep = \"\\n\")\n\n## extract mapping old_names with new_names\nmapping_old_new_281022 <- readxl::read_excel(\"data/Table of compounds_whole_2025-04-28.xlsx\", \n                                             sheet = \"Sample Mapping 281022\")\n\nlabels_old_new_281022 <- setNames(object = mapping_old_new_281022$OLD_replicate_label, \n                                  nm = mapping_old_new_281022$NEW_replicate_label)\n\n## apply change labelling\nexp281022_expression <- exp281022_expression |> \n  dplyr::rename(dplyr::all_of(labels_old_new_281022))\n\nreadr::write_csv(exp281022_expression, \"data/barcode-counts/exp281022.csv\")\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{#lst-281022-time-course .r .cell-code  lst-cap=\"Update time course experiences.\"}\nexp281022_expression_timecourse <- readr::read_csv(\"data/barcode-counts/exp281022_time course.csv\") \n## cat(colnames(exp281022_expression_timecourse), file = \"281022_timecourse_old_labels.txt\", sep = \"\\n\")\n\n## update colnames ----\n\nmapping_old_new_time_course <- read_excel(\"data/Table of compounds_whole_2025-04-28.xlsx\", \n                                     sheet = \"Sample Mapping Time Course\")\n\nlabels_old_new_time_course <- setNames(object = mapping_old_new_time_course$OLD_replicate_label, \n                                       nm = mapping_old_new_time_course$NEW_replicate_label)\n\n## apply change labelling\nexp281022_expression_timecourse <- exp281022_expression_timecourse |> \n  dplyr::rename(dplyr::all_of(labels_old_new_time_course))\n\nreadr::write_csv(exp281022_expression_timecourse,\n                 \"data/barcode-counts/exp281022_time course.csv\")\n\n## To evaluate whether controls are different between experiment 281022 and 281022 Time Course\ncontrols_exp281022 <- exp281022_expression |> \n  select(key_barcode, dplyr::matches(\"^ctl\")) |> \n  dplyr::inner_join(exp281022_expression_timecourse |> \n                      select(key_barcode, dplyr::matches(\"^Ctrl\")),\n                    by=\"key_barcode\")\ncor(controls_exp281022$ctl2, controls_exp281022$Ctrl2) ## they strongly correlate with each other, but not a perfect match -> controls are indeed distinct\n\n```\n:::\n\n\n\n\n\n\n\n\n\n<!-- ### Additional comments -->\n\n<!-- - `exp130921_in_vivo`: cells injected in living mice (control versus osermintinimb). -->\n<!-- - `exp281022`: control, protac, cetuximab and gefitinib ($n=4$ replicates each time) were sampled in T25 flasks. P42 and P43 correspond to cells grown without treatment for 42 or 43 passages, and were used for evaluating *barcode drift* technical artefact. -->\n<!-- - `exp281022_time course`: time course experiment. -->\n\n### TODO: barcode counts inconsistencies\n\nThings to consider:\n\n- [Format used is **French csv**, instead of international CSV. CSV means for 'comma-separated value', maybe consider switching [Excel settings](https://support.microsoft.com/en-us/office/import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba).]{fg=\"red\"}\n- [I rename the first colname of each expression file as `barcode_id`, storing unequivocal tag.]{fg=\"red\"}\n- Some barcode counts exhibit final line `index`, for which reason?\n\n### Overview of barcode counts\n\nWe report in @tbl-overview-barcode-counts a summary of the barcode counts (File location, `batch_id`, and dimensions of the counts matrix) considered for the generation of the Heatmaps, and the construction of a drug-drug network.\n\n\n\n\n\n\n::: {#tbl-overview-barcode-counts .cell layout-ncol=\"2\" layout-align=\"center\" tbl-cap='Overview of the Barcoding Batches.' tbl-subcap='[\"Kept Batches\",\"Removed batches\"]'}\n\n```{.r .cell-code}\n## 1) summarise kept batches ----\nbarcode_files <- list.files(\"./data/barcode-counts/\",\n                            pattern = \"exp.*\\\\.csv\",\n                            full.names = TRUE)\n\nkept_barcode_summaries <- purrr::map(barcode_files, function(filename) {\n  barcode_counts <- readr::read_csv(filename, show_col_types = FALSE)\n  experience_name <- filename |> basename() |> tools::file_path_sans_ext()\n  experience_summary <- tibble::tibble(`Experience Name`= experience_name,\n                                       Features= paste0(\"Barcode matrix contains: \",\n                                                        nrow(barcode_counts),\n                                                        \" unique barcode IDs, and \",\n                                                        ncol(barcode_counts)-1, \" replicates.\"))\n  return(experience_summary)\n}) |>\n  purrr::list_rbind()\nflextable::flextable(kept_barcode_summaries) |> \n  bold(part=\"header\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-98665c74{}.cl-9854e3b8{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9854e3f4{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-985c9cde{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-985cee50{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-985cee64{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-985cee6e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-98665c74'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-985cee50\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3b8\">Experience Name</span></p></th><th class=\"cl-985cee50\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3b8\">Features</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp010821</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 869714 unique barcode IDs, and 16 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp040821</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 869714 unique barcode IDs, and 16 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp070222</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 93132 unique barcode IDs, and 68 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp130921</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 627539 unique barcode IDs, and 24 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp151121</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 844434 unique barcode IDs, and 60 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp181021</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 813579 unique barcode IDs, and 59 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp200921</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 627539 unique barcode IDs, and 40 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp200921_dose response osim</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 1067031 unique barcode IDs, and 20 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp220322</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 93132 unique barcode IDs, and 66 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp271221</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 844434 unique barcode IDs, and 80 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp281022</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 315642 unique barcode IDs, and 22 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp281022_time course</span></p></td><td class=\"cl-985cee64\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 398004 unique barcode IDs, and 51 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-985cee6e\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">exp300821</span></p></td><td class=\"cl-985cee6e\"><p class=\"cl-985c9cde\"><span class=\"cl-9854e3f4\">Barcode matrix contains: 413335 unique barcode IDs, and 28 replicates.</span></p></td></tr></tbody></table></div>\n```\n\n:::\n\n```{.r .cell-code}\n\n## 2) summarise discarded batches ----\ndiscarded_files <- list.files(\"./data/barcode-counts/temp discarded/\",\n                            pattern = \"exp.*\\\\.csv\",\n                            full.names = TRUE)\n\n## change format + barcode name\nbarcode_discarded_summaries <- purrr::map(discarded_files, function(filename) {\n  barcode_counts <- readr::read_csv(filename, show_col_types = FALSE)\n  experience_name <- filename |> basename() |> tools::file_path_sans_ext()\n  experience_summary <- tibble::tibble(`Experience Name`= experience_name,\n                                       Features= paste0(\"Barcode matrix contains: \",\n                                                        nrow(barcode_counts),\n                                                        \" unique barcode IDs, and \",\n                                                        ncol(barcode_counts)-1, \" replicates.\"))\n  return(experience_summary)\n}) |>\n  purrr::list_rbind()\n\nflextable::flextable(barcode_discarded_summaries) |> \n  bold(part=\"header\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-9a20a402{}.cl-9a0f7ef2{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9a0f7f06{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9a16b55a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9a170a64{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9a170a78{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9a170a82{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-9a20a402'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-9a170a64\"><p class=\"cl-9a16b55a\"><span class=\"cl-9a0f7ef2\">Experience Name</span></p></th><th class=\"cl-9a170a64\"><p class=\"cl-9a16b55a\"><span class=\"cl-9a0f7ef2\">Features</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-9a170a78\"><p class=\"cl-9a16b55a\"><span class=\"cl-9a0f7f06\">exp130921_in vivo</span></p></td><td class=\"cl-9a170a78\"><p class=\"cl-9a16b55a\"><span class=\"cl-9a0f7f06\">Barcode matrix contains: 813579 unique barcode IDs, and 16 replicates.</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-9a170a82\"><p class=\"cl-9a16b55a\"><span class=\"cl-9a0f7f06\">exp200921_dose response osim</span></p></td><td class=\"cl-9a170a82\"><p class=\"cl-9a16b55a\"><span class=\"cl-9a0f7f06\">Barcode matrix contains: 813579 unique barcode IDs, and 20 replicates.</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n\n\n\nFrom @tbl-overview-barcode-counts, 13 barcode experiences are included in the analysis, whereas 2 batches/experiences are filtered out.\n\n\n## Phenotype metadata cleaning {#sec-metadata-phenotypes}\n\n- [General question: what's the difference between `Run Date` and `Experiment Date`?]{fg=\"red\"}\n\nMost of the R instructions reported in this section aim at rendering the `Table of compounds` file compliant with the `tidy` format, see @tip-tidyformat. These data-wrangling operations are split in 4 steps:\n\n1. In @lst-process-pheno1, we homogenise `Concentrations`, `Date` and `Duration` to ISO standards, while dealing with erroneous missing values generated by fused Excel cells. [Besides, we removed special, non-ascii characters that could not be processed by visualisation plots, such as $NF-\\kappa B$.]{fg=\"red\"}\n\n2. In @lst-process-pheno2, we retrieve from each individual barcode counts profile, the individual replicates ID identifying unequivocally each replicate. We set apart replicates that could be mapped back to original `Table of compounds` file.\n\n3. In @lst-process-pheno3, we merge together in a comprehensive phenotype table the short `Samples_ID` (short term referring to drugs listed in `Compound` column), the full `Compound` (complete name of drugs) and map each of them to its complete list of replicates (from 2 to 8). We save the output in `data-derived`.\n\n4. Finally, in @lst-check-pheno-data-1 and @lst-check-pheno-data-2, we perform several posterior *data integrity checks* to verify if i) we were able to map each individual replicate ID to its original ID in `Table of compounds`, and ii) if the number of replicates reported in [`Table of compounds`](data/Table of compounds_whole_2025-04-28.xlsx) was consistent with the number of barcode profiles.\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{#lst-process-pheno1 .r .cell-code  lst-cap=\"Coerce original Excel file reporting experimental design to tidy format.\"}\npheno_colnames <- c(Pathway = \"Pathways\", MoA = \"...2\", \n                    Compound = \"Samples\", Replicates = \"Replicates\",\n                    Concentrations = \"Concentrations\", Date = \"Experiment date\",\n                    `Run date` = \"Run date\", Duration=\"Duration\", \n                    Kept=\"Kept\", Comments = \"Comments\")\n\n## prune irrelevant colnames ----\n## data/Table of compounds_stringent_2025-04-18.xlsx\npheno_data <- readxl::read_xlsx(\"data/Table of compounds_whole_2025-04-28.xlsx\",\n                                sheet = \"Experimental Design\",\n                                col_types = c(rep(\"text\", 3), \"numeric\", \n                                              rep(\"text\", 4), \"logical\", \"text\")) |>\n  dplyr::rename(dplyr::all_of(pheno_colnames)) |>\n  tidyr::fill(Pathway, MoA, .direction = \"down\")\n\npheno_data_discarded <- pheno_data |> \n  dplyr::filter(!Kept)\n\n## Add batches and correct for fused Excel cells ----\n\npheno_data <- pheno_data |> \n  ## extract last 6 numbers\n  dplyr::mutate(Compound = if_else(grepl(\"Control\", MoA, ignore.case = TRUE),\n                                  MoA, Compound),\n                `Run date` = stringr::str_sub(`Run date`, -6, -1),\n                Batch_ID= paste0(\"exp\", Date)) |> \n  tidyr::fill(Compound, .direction = \"down\") |>\n  ## remove unwanted replicates\n  dplyr::filter(Kept) |> \n  dplyr::mutate(Batch_ID = dplyr::if_else(Comments %in% c(\"Dose Response\"), \n                                          \"exp200921_dose response osim\", Batch_ID)) |> \n  dplyr::mutate(Batch_ID = dplyr::if_else(Comments %in% c(\"Time Course\"), \n                                          \"exp281022_time course\", Batch_ID), \n                Pathway = if_else(is.na(Pathway), MoA, enc_to_ascii(Pathway))) |> \n  dplyr::select(- Comments, -Kept) |> \n  dplyr::distinct(.keep_all = TRUE) ## remove duplicates\n\n## format concentrations, creating both 'Concentrations_ID' and 'Concentrations' in Moles ----\npheno_data <- pheno_data |> \n  dplyr::mutate(Concentrations=if_else(Compound==\"Control\", \"000 uM\", Concentrations)) |> \n  dplyr::mutate(Concentrations=if_else(Compound==\"Osimertinb+sorafenib\", \"015 uM\", Concentrations)) |>\n  tidyr::separate_wider_delim(Concentrations, delim = \" \", names = c(\"Concentrations Value\", \"Unit\"), cols_remove = FALSE) |> \n  dplyr::rename(OLD_Concentrations=Concentrations) |> \n  dplyr::mutate(Unit = case_when(\n    Unit %in% c(\"uM\", \"µM\", \"µg/ml\") ~ \"u\",\n    Unit == \"nM\" ~ \"n\", \n    Unit %in% c(\"mg/kg\", \"mM\") ~ \"m\", \n  )) |> \n  dplyr::mutate(Concentrations=parse_number(`Concentrations Value`, trim_ws = TRUE, \n                                            locale = locale(decimal_mark = \",\", grouping_mark = \".\"))) |> \n   dplyr::mutate(Concentrations = case_when(\n    Unit == \"u\" ~ Concentrations *10^-6,\n    Unit == \"n\" ~ Concentrations *10^-9, \n    Unit == \"m\" ~ Concentrations *10^-3)) |> \n  dplyr::mutate(`Concentrations Value`=parse_number(`Concentrations Value`, trim_ws = TRUE, \n                                            locale = locale(decimal_mark = \",\", grouping_mark = \".\")) |> \n                  format_concentrations()) |> \n  tidyr::unite(col =\"Concentrations_ID\", `Concentrations Value`, Unit, sep = \"\")\n\n## format Durations, creating both 'Duration_ID' and 'Duration' as an integer value in Days ----\npheno_data <- pheno_data |> \n  ## extract last 6 numbers, as the only ones used for identification of samples downstream\n  dplyr::mutate(Duration_ID = Duration,\n                Duration = parse_number(Duration, trim_ws = TRUE, \n                                        locale = locale(decimal_mark = \".\")), \n                Duration = dplyr::if_else(grepl(\"m$\",  Duration_ID),\n                                          Duration*30, Duration)) \n  \n```\n:::\n\n\n\n\n\n\n::: {.callout-important title=\"Metadata inconsistencies and Conversion to UIC Units\" collapse=\"true\"}\n\n<!-- - [For compound `SBI-0206965`, both `Date` and `Run date` were wrongly reported (either not stored in the proper barcode counts profile, or mistyped in `Table of Compound`).]{fg=\"red\"} -->\n\n- [In `Run date`, when there was a range instead of a fixed Date, I kept only the end of the interval, as used for labelling colnames in barcode counts.]{fg=\"red\"}\n\n- [Homogenise units for the `Concentrations` colname: convert everything to moles.]{fg=\"red\"}\n\n- [Homogenise units for `Date` and `Run date`, using international ISO 8601 format: `YYYY-MM-DD`]{fg=\"red\"}\n\n:::\n\nIn @lst-process-pheno2 and @lst-process-pheno3, we identify which raw barcode counts matrices avalaible in folder `barcode-counts` are not reported in the global experimental dataset, and reciprocally. Finally, we only **keep experiences that are both reported in `Table of compounds` and present in `barcode-counts` folder.**.\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{#lst-process-pheno2 .r .cell-code  lst-cap=\"Identify shared experience IDs between experimental design table (`Table of compounds`), and barcode-count counts profiles.\"}\n## keep only relevant files \nbarcodes_filenames <- list.files(\"./data/barcode-counts/\",\n                                pattern = \"^exp.*\\\\.csv$\")\n\nbarcodes_IDs <- readxl::read_xlsx(\"data/Table of compounds_whole_2025-04-28.xlsx\",\n                                       sheet=\"Batch Mapping\") |> \n  select(Filename, Batch_ID) |> \n  filter(!Batch_ID %in% c(\"exp130921_in vivo\")) |> \n  mutate(Filename =paste0(Filename, \".csv\"), \n         Date = stringr::str_extract(Batch_ID, \"(?<=^exp)[[:digit:]]{6}\"))\n\n```\n:::\n\n\n\n\n\n\n\n<!-- ::: {.callout-important title=\"Missing information on Table of Compound and missing Experiences\"} -->\n\n<!-- We note the following inconsistencies: -->\n\n<!-- 1. Using ``{r} setdiff(barcodes_filenames, barcodes_IDs$Filename)``, we note that the following files present in `data-raw` will be excluded: . For details, report to @sec-select-exp. -->\n\n<!-- 2. Using ``{r} setdiff(barcodes_IDs$Filename, barcodes_filenames)``, we certified that all remaining filenames in the folder were properly mapped. -->\n\n<!-- 3. Using ``{r} setdiff(pheno_data$Batch_ID, barcodes_IDs$Batch_ID)``, all experiments  reported in original `Table of Compound` could have been mapped back to an existing experiment, once `Control - time zero` have been discarded.  -->\n\n<!-- ::: -->\n\nTo generate the final phenotype dataset, we only keep experiences that were reported both in `Table of Compound` and folder `barcode-counts` in @lst-process-pheno3. [**Please ensure that `Drugs Mapping` sheet in [`Table of compounds`](data/Table of compounds_whole_2025-04-28.xlsx) is correct.**]{fg=\"red\"}\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{#lst-process-pheno3 .r .cell-code  lst-cap=\"Map each compound to its full list of replicates. Generate a `Batch_ID` to unequivocally ientify each run of experiences, and convert all run Dates to their international format.\"}\n## step 1) keep only shared Batch_ID experiences ----\nbarcodes_IDs <- barcodes_IDs |>\n  dplyr::semi_join(pheno_data, by=\"Batch_ID\")\n## exp201021 is discarded, that's normal, we just want to keep the controls!!\npheno_data <- pheno_data |>\n  dplyr::semi_join(barcodes_IDs, by=\"Batch_ID\")\n\n## step 2) extract individual replicate IDs directly from sample experiences ----\n## Filename <- \"exp281022.csv\"; Batch_ID <- \"exp281022\"; Date <- \"281022\"\nID_mapping <- purrr::pmap(barcodes_IDs, function(Filename, Batch_ID, Date) {\n  ## build path\n  counts_path <- file.path(\"data\",\"barcode-counts\", \n                               paste0(Filename))\n  \n  ## extract replicate names (reading the header)\n  replicates_ID <- strsplit(readLines(counts_path, n = 1), split = \",\")[[1]] |>\n    str_subset(\"\\\\S\") |> ## remove empty strings and 'key'\n    str_subset(\"barcode_id\", negate = TRUE)\n\n  ## ID: combination of letters, numbers and -, followed by '[1-4]_', starting the sample's name\n  dataset_ID <- tibble::tibble(Batch_ID = Batch_ID, \n                               Date = stringr::str_extract(replicates_ID,\n                                                           \"(?<=_exp)[[:alnum:]]{6}\"),\n                               Replicates_ID = replicates_ID,\n                               `Run date` = stringr::str_extract(replicates_ID,\n                                                                 \"(?<=_run)[[:alnum:]]{6}(?=_)\"),\n                               Concentrations_ID = stringr::str_extract(replicates_ID, \n                                                                        \"(?<=[1-8]_)[[:digit:]]{3}[gmnux]{1}(?=_exp)\")) |> \n    ## account for second notation syntax for concentrations\n    dplyr::mutate(Concentrations_ID = if_else(is.na(Concentrations_ID), \n                                              stringr::str_extract(replicates_ID,\n                                                                   \"(?<=[1-8]_)[0-9]{1}\\\\.[0-9]{2}[gmnux]{1}(?=_exp)\"),\n                                              Concentrations_ID))\n  \n  ## Deal with two time notations\n  if (grepl(\"Time\",Batch_ID, ignore.case = TRUE)) {\n    dataset_ID <- dataset_ID |> \n      dplyr::mutate (Samples_ID = stringr::str_extract(replicates_ID,\n                                                       \"(?<=_)[[[:alnum:]]\\\\-]+(?=[1-8]_)\"), \n                     Duration_ID=stringr::str_extract(replicates_ID,\n                                                       \"^[[[:alnum:]]\\\\.]{1,3}[dm](?=_)\"))\n  }\n  else {\n      dataset_ID <- dataset_ID |> \n      dplyr::mutate (Samples_ID = stringr::str_extract(replicates_ID,\n                                                       \"^[[[:alnum:]]\\\\-]+(?=[1-8]{1}_)\"), \n                     Duration_ID=\"9d\")\n  }\n                                 \n  return(dataset_ID)\n}) |>\n  purrr::list_rbind()\n\n## deal with specific p42 and p43\nID_mapping <- ID_mapping |> \n  dplyr::mutate(Samples_ID = if_else(grepl(\"^p42\", Replicates_ID), \"p42\", Samples_ID), \n                Samples_ID = if_else(grepl(\"^p43\", Replicates_ID), \"p43\", Samples_ID))\n\n## remove irrelavant samples\nID_mapping <- ID_mapping |> \n  dplyr::filter(!grepl(\"^p42|^p43|^CTRL\", Replicates_ID))\n\n\n## detect miscatech samples\n## ID_mapping_missing <- ID_mapping |>\n##   filter(if_any(everything(), is.na))\n\n## step 3) map short compound IDs with full compound names ----\nmapping_compounds <- readxl::read_xlsx(\"data/Table of compounds_whole_2025-04-28.xlsx\",\n                                sheet = \"Drugs Mapping\")\nID_mapping <- ID_mapping |> \n  inner_join(mapping_compounds, by = \"Samples_ID\")\n## test <- ID_mapping |> anti_join(mapping_compounds, by = \"Samples_ID\")\n## test2 <- mapping_compounds |> anti_join(ID_mapping, by = \"Samples_ID\")\n```\n:::\n\n\n\n\n\n\n<!-- - `X13271` with concentration `005u`, both run on `Run Date: 180821`, have been discarded in *counts*. -->\n\nFinally, in @lst-check-pheno-data-1, we map all replicates (one column in a given barcode count matrix) to its comprehensive metadata descripion (stored in `Tables of compounds`), using as **primary and foreign keys** the following 6 variables: `Batch_ID`,  `Compound`, `Duration_ID`, `Run date`, `Date`, and `Concentrations_ID`.\n\n\n\n\n\n\n::: {#tbl-check-pheno-data .cell layout-align=\"center\" tbl-cap='Identify set of experiences reported in `Table of compounds` that could not be mapped against their corresponding Barcode counts replicates. We check this information with an `anti_join` between original *phenotype* and *counts*, returning samples from `Table of Compound` that could not have been mapped back.'}\n\n```{#lst-check-pheno-data-1 .r .cell-code  lst-cap=\"Extract discarded replicates\"}\nreplicates_discarded <- dplyr::anti_join(ID_mapping, pheno_data,\n                                     by = c(\"Batch_ID\",  \"Compound\", \"Duration_ID\",\n                                            \"Run date\", \"Date\", \"Concentrations_ID\"))\n\npheno_data_unmapped <- dplyr::anti_join(pheno_data,\n                                     ID_mapping,\n                                     by = c(\"Batch_ID\",  \"Compound\", \"Duration_ID\",\n                                            \"Run date\", \"Date\", \"Concentrations_ID\"))\n\npheno_data_unmapped |> \n  arrange(Compound, Date, Concentrations_ID) |> \n  flextable() |> \n  bold(part = \"header\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-9af7ac04{}.cl-9ae88422{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9aeeafc8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9aeeafd2{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9aeef4ba{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9aeef4c4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-9af7ac04'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-9aeef4ba\"><p class=\"cl-9aeeafc8\"><span class=\"cl-9ae88422\">Pathway</span></p></th><th class=\"cl-9aeef4ba\"><p class=\"cl-9aeeafc8\"><span class=\"cl-9ae88422\">MoA</span></p></th><th class=\"cl-9aeef4ba\"><p class=\"cl-9aeeafc8\"><span class=\"cl-9ae88422\">Compound</span></p></th><th class=\"cl-9aeef4c4\"><p class=\"cl-9aeeafd2\"><span class=\"cl-9ae88422\">Replicates</span></p></th><th class=\"cl-9aeef4ba\"><p class=\"cl-9aeeafc8\"><span class=\"cl-9ae88422\">Concentrations_ID</span></p></th><th class=\"cl-9aeef4ba\"><p class=\"cl-9aeeafc8\"><span class=\"cl-9ae88422\">OLD_Concentrations</span></p></th><th class=\"cl-9aeef4ba\"><p class=\"cl-9aeeafc8\"><span class=\"cl-9ae88422\">Date</span></p></th><th class=\"cl-9aeef4ba\"><p class=\"cl-9aeeafc8\"><span class=\"cl-9ae88422\">Run date</span></p></th><th class=\"cl-9aeef4c4\"><p class=\"cl-9aeeafd2\"><span class=\"cl-9ae88422\">Duration</span></p></th><th class=\"cl-9aeef4ba\"><p class=\"cl-9aeeafc8\"><span class=\"cl-9ae88422\">Batch_ID</span></p></th><th class=\"cl-9aeef4c4\"><p class=\"cl-9aeeafd2\"><span class=\"cl-9ae88422\">Concentrations</span></p></th><th class=\"cl-9aeef4ba\"><p class=\"cl-9aeeafc8\"><span class=\"cl-9ae88422\">Duration_ID</span></p></th></tr></thead></table></div>\n```\n\n:::\n:::\n\n\n\n\n\n\nIn @tbl-check-pheno-data-2, we check discrepancies between the number of barcode replicates reported in `Table of compounds` with the number of replicates avalaible in barcode counts matrices. [And it turned out that `compound`: XAV-939, `Date`: 220322, is reported with 4 replicates, while only 2 could be found in [`exp220322` barcode count matrix](./data/barcode-counts/exp220322.csv)]{fg=\"red\"}\n\n\n\n\n\n\n::: {#tbl-check-pheno-data-2 .cell layout-align=\"center\" tbl-cap='Secound round of data wrangling quality controls on *counts* versus *phenotype data*, focusing on divergent number of replicates.'}\n\n```{#lst-check-pheno-data-2 .r .cell-code  lst-cap=\"Secound round of data wrangling quality controls on *counts* versus *phenotype data*, focusing on divergent number of replicates.\"}\nreplicate_inconsistencies <- pheno_data |> \n  dplyr::inner_join(ID_mapping,\n                    by = c(\"Batch_ID\", \"Date\", \n                           \"Compound\", \"Run date\",\n                           \"Concentrations_ID\", \"Duration_ID\")) |>\n  group_by(Batch_ID, Compound, Date, Replicates, Concentrations_ID,Duration_ID) |>\n  summarise(n=n()) |>\n  filter(n!=Replicates)\n\nflextable(replicate_inconsistencies) |>\n  autofit() |>\n  bold(part = \"header\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-9ba8f608{}.cl-9b9a1070{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9b9a1084{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9b9ff4ae{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9b9ff4cc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9ba02d16{width:1.041in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d20{width:1.033in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d2a{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d34{width:0.998in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d3e{width:1.551in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d3f{width:1.1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d48{width:0.37in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d52{width:1.041in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d53{width:1.033in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d5c{width:0.795in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d5d{width:0.998in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d66{width:1.551in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d70{width:1.1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9ba02d71{width:0.37in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-9ba8f608'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-9ba02d16\"><p class=\"cl-9b9ff4ae\"><span class=\"cl-9b9a1070\">Batch_ID</span></p></th><th class=\"cl-9ba02d20\"><p class=\"cl-9b9ff4ae\"><span class=\"cl-9b9a1070\">Compound</span></p></th><th class=\"cl-9ba02d2a\"><p class=\"cl-9b9ff4ae\"><span class=\"cl-9b9a1070\">Date</span></p></th><th class=\"cl-9ba02d34\"><p class=\"cl-9b9ff4cc\"><span class=\"cl-9b9a1070\">Replicates</span></p></th><th class=\"cl-9ba02d3e\"><p class=\"cl-9b9ff4ae\"><span class=\"cl-9b9a1070\">Concentrations_ID</span></p></th><th class=\"cl-9ba02d3f\"><p class=\"cl-9b9ff4ae\"><span class=\"cl-9b9a1070\">Duration_ID</span></p></th><th class=\"cl-9ba02d48\"><p class=\"cl-9b9ff4cc\"><span class=\"cl-9b9a1070\">n</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-9ba02d52\"><p class=\"cl-9b9ff4ae\"><span class=\"cl-9b9a1084\">exp220322</span></p></td><td class=\"cl-9ba02d53\"><p class=\"cl-9b9ff4ae\"><span class=\"cl-9b9a1084\">XAV-939</span></p></td><td class=\"cl-9ba02d5c\"><p class=\"cl-9b9ff4ae\"><span class=\"cl-9b9a1084\">220322</span></p></td><td class=\"cl-9ba02d5d\"><p class=\"cl-9b9ff4cc\"><span class=\"cl-9b9a1084\">4</span></p></td><td class=\"cl-9ba02d66\"><p class=\"cl-9b9ff4ae\"><span class=\"cl-9b9a1084\">080u</span></p></td><td class=\"cl-9ba02d70\"><p class=\"cl-9b9ff4ae\"><span class=\"cl-9b9a1084\">9d</span></p></td><td class=\"cl-9ba02d71\"><p class=\"cl-9b9ff4cc\"><span class=\"cl-9b9a1084\">2</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n\n\n\n### Save phenotype Metadata\n\nBy applying all the formatting analyses reported in @sec-metadata-phenotypes, we generate in @tbl-phenotype-metadata-saving a global metadata phenotypic table, adhering to tidy principles [@tip-tidyformat]. \n\n::: {#tip-tidyformat .callout-tip title=\"Tidy Data Format (Key Principles)\" collapse=\"true\"}\n\n1. **Each variable has its own column**.\n2. **Each observation has its own row** – Every row corresponds to one observation.\n3. **Each value has its own cell** – Each cell contains a single, unique value.\n\nThis format streamlines data wrangling, and generally speaking, data analysis and visualisation. In other words, prefer simpler `CSV` formats for the experimental design, and avoid *cell fusion* in Excel documents. Finally, for the formatted tabular representation in documentations, I use `flextable`.\n\n:::\n\n\n\n\n\n\n::: {#tbl-phenotype-metadata-saving .cell layout-align=\"center\"}\n\n```{#lst-save-pheno-metadata .r .cell-code  lst-cap=\"Save the final metadata annotations for barcodes, using Today's date for historical versioning.\"}\n## step 4) Use international date formats ----\npheno_data_formatted <- pheno_data |> \n  dplyr::inner_join(ID_mapping,\n                    by = c(\"Batch_ID\", \"Date\", \n                           \"Compound\", \"Run date\",\n                           \"Concentrations_ID\", \"Duration_ID\")) |> \n  dplyr::select(Batch_ID, Pathway, MoA,\n                Compound, Samples_ID, \n                Replicates, Replicates_ID,\n                Concentrations, Concentrations_ID, \n                Date, `Run date`, Duration, Duration_ID) |> \n  ## convert to ISO 1860 Date format\n  mutate(Date = lubridate::dmy(Date) |> format(),\n         `Run date`= lubridate::dmy(`Run date`), \n  ## artifically de-duplicate controls for exp, simplify the analytical workflow \n  Replicates_ID = dplyr::if_else(Batch_ID %in% c(\"exp200921_dose response osim\") &\n                                   Compound==\"Control\",\n                                 gsub(\"exp200921_\", \"exp200921_dose_response_\", Replicates_ID),\n                                 Replicates_ID))\n\n## 2) QC: guarantee uniqueness of the replicates\npheno_data_deduplicated <- pheno_data_formatted |> \n  dplyr::distinct(Replicates_ID, .keep_all = TRUE)\nall.equal(pheno_data_deduplicated, pheno_data_formatted)\n##  [1] TRUE\n```\n\n```{#lst-save-pheno-metadata .r .cell-code  lst-cap=\"Save the final metadata annotations for barcodes, using Today's date for historical versioning.\"}\n\n## 3) save as .xlsx file discarded and preserved replicates\n\nbarcode_counts_summaries <- list(\"kept counts\" = kept_barcode_summaries,\n                                 \"kept compounds\" = pheno_data,\n                                 \"kept replicates\" = pheno_data_formatted |> \n                                   select(Compound, Replicates_ID),\n                                 \"discarded counts\" = barcode_discarded_summaries, \n                                 \"discarded compounds\"=pheno_data_discarded, \n                                 \"discarded replicates\" = replicates_discarded)\n\nopenxlsx::write.xlsx(x = barcode_counts_summaries,\n                     file = paste0(\"./data/logs/barcode_metadata_overview_\",\n                                   today_date,\".xlsx\"),\n                     overwrite = TRUE, asTable = TRUE)\n\n\n## 4) save the tidy phenotype metatada table ----\nreadr::write_csv(pheno_data_formatted,\n                 file = paste0(\"data/pheno_data_metadata_\", today_date,\".csv\"))\n\nflextable::flextable(head(pheno_data_formatted)) |> \n  autofit() |> \n  bold(part=\"header\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-9d1debe2{}.cl-9d0f6e78{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9d0f6e8c{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9d1550a4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9d1550ae{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9d157ff2{width:1.041in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d157ffc{width:0.871in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158006{width:0.778in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158010{width:1.033in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15801a{width:1.117in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158024{width:0.998in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15802e{width:3.165in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15802f{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158038{width:1.551in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158042{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158043{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15804c{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15804d{width:1.1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158056{width:1.041in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158057{width:0.871in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158060{width:0.778in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158061{width:1.033in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15806a{width:1.117in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15806b{width:0.998in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158074{width:3.165in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158075{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15807e{width:1.551in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15807f{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158088{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d158092{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15809c{width:1.1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d15809d{width:1.041in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580a6{width:0.871in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580a7{width:0.778in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580b0{width:1.033in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580ba{width:1.117in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580bb{width:0.998in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580c4{width:3.165in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580ce{width:1.313in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580d8{width:1.551in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580d9{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580e2{width:1.067in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580ec{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9d1580f6{width:1.1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-9d1debe2'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-9d157ff2\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e78\">Batch_ID</span></p></th><th class=\"cl-9d157ffc\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e78\">Pathway</span></p></th><th class=\"cl-9d158006\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e78\">MoA</span></p></th><th class=\"cl-9d158010\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e78\">Compound</span></p></th><th class=\"cl-9d15801a\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e78\">Samples_ID</span></p></th><th class=\"cl-9d158024\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e78\">Replicates</span></p></th><th class=\"cl-9d15802e\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e78\">Replicates_ID</span></p></th><th class=\"cl-9d15802f\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e78\">Concentrations</span></p></th><th class=\"cl-9d158038\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e78\">Concentrations_ID</span></p></th><th class=\"cl-9d158042\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e78\">Date</span></p></th><th class=\"cl-9d158043\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e78\">Run date</span></p></th><th class=\"cl-9d15804c\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e78\">Duration</span></p></th><th class=\"cl-9d15804d\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e78\">Duration_ID</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-9d158056\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">exp010821</span></p></td><td class=\"cl-9d158057\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d158060\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d158061\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d15806a\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro</span></p></td><td class=\"cl-9d15806b\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">4</span></p></td><td class=\"cl-9d158074\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro1_000u_exp010821_run180821_03</span></p></td><td class=\"cl-9d158075\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">0</span></p></td><td class=\"cl-9d15807e\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">000u</span></p></td><td class=\"cl-9d15807f\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">2021-08-01</span></p></td><td class=\"cl-9d158088\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">2021-08-18</span></p></td><td class=\"cl-9d158092\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">9</span></p></td><td class=\"cl-9d15809c\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">9d</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-9d158056\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">exp010821</span></p></td><td class=\"cl-9d158057\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d158060\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d158061\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d15806a\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro</span></p></td><td class=\"cl-9d15806b\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">4</span></p></td><td class=\"cl-9d158074\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro2_000u_exp010821_run180821_04</span></p></td><td class=\"cl-9d158075\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">0</span></p></td><td class=\"cl-9d15807e\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">000u</span></p></td><td class=\"cl-9d15807f\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">2021-08-01</span></p></td><td class=\"cl-9d158088\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">2021-08-18</span></p></td><td class=\"cl-9d158092\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">9</span></p></td><td class=\"cl-9d15809c\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">9d</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-9d158056\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">exp010821</span></p></td><td class=\"cl-9d158057\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d158060\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d158061\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d15806a\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro</span></p></td><td class=\"cl-9d15806b\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">4</span></p></td><td class=\"cl-9d158074\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro3_000u_exp010821_run180821_05</span></p></td><td class=\"cl-9d158075\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">0</span></p></td><td class=\"cl-9d15807e\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">000u</span></p></td><td class=\"cl-9d15807f\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">2021-08-01</span></p></td><td class=\"cl-9d158088\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">2021-08-18</span></p></td><td class=\"cl-9d158092\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">9</span></p></td><td class=\"cl-9d15809c\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">9d</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-9d158056\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">exp010821</span></p></td><td class=\"cl-9d158057\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d158060\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d158061\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d15806a\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro</span></p></td><td class=\"cl-9d15806b\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">4</span></p></td><td class=\"cl-9d158074\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro4_000u_exp010821_run180821_06</span></p></td><td class=\"cl-9d158075\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">0</span></p></td><td class=\"cl-9d15807e\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">000u</span></p></td><td class=\"cl-9d15807f\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">2021-08-01</span></p></td><td class=\"cl-9d158088\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">2021-08-18</span></p></td><td class=\"cl-9d158092\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">9</span></p></td><td class=\"cl-9d15809c\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">9d</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-9d158056\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">exp040821</span></p></td><td class=\"cl-9d158057\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d158060\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d158061\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d15806a\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro</span></p></td><td class=\"cl-9d15806b\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">4</span></p></td><td class=\"cl-9d158074\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro1_000u_exp040821_run180821_25</span></p></td><td class=\"cl-9d158075\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">0</span></p></td><td class=\"cl-9d15807e\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">000u</span></p></td><td class=\"cl-9d15807f\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">2021-08-04</span></p></td><td class=\"cl-9d158088\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">2021-08-18</span></p></td><td class=\"cl-9d158092\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">9</span></p></td><td class=\"cl-9d15809c\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">9d</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-9d15809d\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">exp040821</span></p></td><td class=\"cl-9d1580a6\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d1580a7\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d1580b0\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Control</span></p></td><td class=\"cl-9d1580ba\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro</span></p></td><td class=\"cl-9d1580bb\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">4</span></p></td><td class=\"cl-9d1580c4\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">Contro2_000u_exp040821_run180821_26</span></p></td><td class=\"cl-9d1580ce\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">0</span></p></td><td class=\"cl-9d1580d8\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">000u</span></p></td><td class=\"cl-9d1580d9\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">2021-08-04</span></p></td><td class=\"cl-9d1580e2\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">2021-08-18</span></p></td><td class=\"cl-9d1580ec\"><p class=\"cl-9d1550ae\"><span class=\"cl-9d0f6e8c\">9</span></p></td><td class=\"cl-9d1580f6\"><p class=\"cl-9d1550a4\"><span class=\"cl-9d0f6e8c\">9d</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n\n\n\n\n**Conclusion**: on a total of 544, 532 replicates are kept, and 12 replicates were removed.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}